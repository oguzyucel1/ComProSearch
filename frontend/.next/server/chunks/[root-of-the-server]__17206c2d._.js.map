{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///Users/oguz/Desktop/ComProSearch/frontend/app/api/start-job/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { createClient } from \"@supabase/supabase-js\";\n\nconst supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.SUPABASE_SERVICE_ROLE_KEY! // âœ… service role key\n);\n\nexport async function POST(req: Request) {\n  try {\n    const { marketplace } = await req.json();\n\n    // Job ekle\n    // Job ekle\n    const { data: job, error } = await supabase\n      .from(\"jobs\")\n      .insert({ marketplace, status: \"pending\" })\n      .select()\n      .single();\n\n    if (error) {\n      return NextResponse.json({ error: error.message }, { status: 500 });\n    }\n\n    // ðŸ‘‡ job_id'yi de workflow'a gÃ¶nder\n    const ghRes = await fetch(\n      `https://api.github.com/repos/${process.env.GH_REPO}/actions/workflows/oksid.yml/dispatches`,\n      {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${process.env.GH_TOKEN}`,\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          ref: \"main\",\n          inputs: {\n            marketplace,\n            job_id: job.id, // âœ… ekledik\n          },\n        }),\n      }\n    );\n\n    if (!ghRes.ok) {\n      const details = await ghRes.text(); // ðŸ‘ˆ detaylÄ± hata gÃ¶receÄŸiz\n      console.error(\"GitHub Actions hatasÄ±:\", details);\n      return NextResponse.json(\n        { error: \"GitHub Actions tetiklenemedi\", details },\n        { status: 500 }\n      );\n    }\n\n    return NextResponse.json({ success: true, job });\n  } catch (err: any) {\n    return NextResponse.json(\n      { error: \"Beklenmeyen hata\", details: err.message },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,WAAW,IAAA,yMAAY,gFAE3B,QAAQ,GAAG,CAAC,yBAAyB;AAGhC,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,WAAW,EAAE,GAAG,MAAM,IAAI,IAAI;QAEtC,WAAW;QACX,WAAW;QACX,MAAM,EAAE,MAAM,GAAG,EAAE,KAAK,EAAE,GAAG,MAAM,SAChC,IAAI,CAAC,QACL,MAAM,CAAC;YAAE;YAAa,QAAQ;QAAU,GACxC,MAAM,GACN,MAAM;QAET,IAAI,OAAO;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QACnE;QAEA,oCAAoC;QACpC,MAAM,QAAQ,MAAM,MAClB,CAAC,6BAA6B,EAAE,QAAQ,GAAG,CAAC,OAAO,CAAC,uCAAuC,CAAC,EAC5F;YACE,QAAQ;YACR,SAAS;gBACP,eAAe,CAAC,OAAO,EAAE,QAAQ,GAAG,CAAC,QAAQ,EAAE;gBAC/C,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,KAAK;gBACL,QAAQ;oBACN;oBACA,QAAQ,IAAI,EAAE;gBAChB;YACF;QACF;QAGF,IAAI,CAAC,MAAM,EAAE,EAAE;YACb,MAAM,UAAU,MAAM,MAAM,IAAI,IAAI,4BAA4B;YAChE,QAAQ,KAAK,CAAC,0BAA0B;YACxC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;gBAAgC;YAAQ,GACjD;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAI;IAChD,EAAE,OAAO,KAAU;QACjB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAoB,SAAS,IAAI,OAAO;QAAC,GAClD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}